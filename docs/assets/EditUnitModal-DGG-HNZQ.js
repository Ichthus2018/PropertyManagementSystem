import{s as y,j as e,z as j,L as w,e as b,q as N,f as C}from"./index-VS4hTV8j.js";import{b as l}from"./vendor-C5zIUBfc.js";import{c}from"./react-paginate-8Es1ox29.js";import{F as S}from"./Units-D3U2hofv.js";import{F}from"./BuildingOffice2Icon-D-1YPzJO.js";import"./ui-DPhHsU_z.js";import"./DataTable-D3-ZNYCt.js";import"./ImageUploader-C7sQW-vZ.js";import"./ExclamationTriangleIcon-DXl3jWQD.js";const m=async({table:n})=>{const{data:a,error:i}=await y.from(n).select("*");if(i)throw new Error(i.message);return a};function T(n){const[a,i]=l.useState({}),[p,r]=l.useState(!1),[g,d]=l.useState(null),{data:o}=c({table:"unit_types"},m),{data:s}=c({table:"leasing_types"},m),{data:f}=c({table:"unit_categories"},m),{data:_}=c({table:"unit_categories_2"},m),{data:t}=c({table:"unit_categories_3"},m);return l.useEffect(()=>{n&&i({name:n.name??"",sqm:n.sqm??0,unit_type_id:n.unit_type_id?.toString()??"",leasing_type_id:n.leasing_type_id?.toString()??"",unit_category_id:n.unit_category_id?.toString()??"",unit_category_2_id:n.unit_category_2_id?.toString()??"",unit_category_3_id:n.unit_category_3_id?.toString()??""})},[n]),{formData:a,isSaving:p,saveError:g,dropdownData:{unitTypes:o||[],leasingTypes:s||[],unitCategories:f||[],unitCategories2:_||[],unitCategories3:t||[]},handlers:{handleInputChange:x=>{const{name:u,value:h}=x.target;i(v=>({...v,[u]:h}))},handleSave:async x=>{if(!n?.id){d("No unit ID provided. Cannot save.");return}r(!0),d(null);try{const u={name:a.name,unit_type_id:a.unit_type_id||null,leasing_type_id:a.leasing_type_id||null,unit_category_id:a.unit_category_id||null,unit_category_2_id:a.unit_category_2_id||null,unit_category_3_id:a.unit_category_3_id||null},{error:h}=await y.from("units").update(u).eq("id",n.id);if(h)throw h;x&&x()}catch(u){console.error("Failed to update unit:",u),d(u.message||"An unexpected error occurred.")}finally{r(!1)}}},isLoading:!o||!s}}function W({isOpen:n,onClose:a,onSuccess:i,unit:p}){const{formData:r,isSaving:g,saveError:d,dropdownData:o,handlers:s,isLoading:f}=T(p),_=()=>{s.handleSave(i)};return e.jsx(j,{appear:!0,show:n,as:l.Fragment,children:e.jsxs(w,{as:"div",className:"relative z-50 font-sans",onClose:a,children:[e.jsx(b,{as:l.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:e.jsx("div",{className:"fixed inset-0 bg-neutral-900/50"})}),e.jsx("div",{className:"fixed inset-0 overflow-y-auto",children:e.jsx("div",{className:"flex min-h-full items-center justify-center xs:p-4 text-center",children:e.jsx(b,{as:l.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0 scale-95",enterTo:"opacity-100 scale-100",leave:"ease-in duration-200",leaveFrom:"opacity-100 scale-100",leaveTo:"opacity-0 scale-95",children:e.jsxs(N,{className:"w-full max-w-4xl transform overflow-hidden rounded-2xl bg-white py-6 px-2 text-left align-middle shadow-2xl transition-all ring-1 ring-neutral-200",children:[e.jsxs(C,{as:"h3",className:"text-2xl font-semibold leading-6 text-neutral-900 flex justify-between items-start md:items-center pb-4 border-b border-neutral-200 px-6",children:[e.jsxs("div",{className:"flex-1",children:["Edit Unit:"," ",e.jsx("span",{className:"font-bold",children:r.name})]}),e.jsx("button",{onClick:a,className:"p-1 rounded-full text-neutral-400 hover:text-neutral-900 hover:bg-neutral-100 transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-neutral-500",children:e.jsx(S,{className:"h-6 w-6"})})]}),f?e.jsx("div",{className:"text-center p-8 text-neutral-600",children:"Loading Form Data..."}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"mt-8 px-6",children:e.jsxs("div",{className:"p-6 border border-neutral-200 rounded-lg bg-neutral-50 max-h-[70vh] overflow-y-auto custom-scrollbar",children:[e.jsxs("h5",{className:"font-bold text-lg text-neutral-800 mb-4 flex items-center",children:[e.jsx(F,{className:"h-5 w-5 mr-2 text-orange-600"}),"Unit Details"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-neutral-700 mb-1",children:"Unit Name"}),e.jsx("input",{type:"text",name:"name",value:r.name??"",onChange:s.handleInputChange,className:"w-full px-4 py-2 border border-neutral-300 rounded-md bg-white focus:outline-none focus:ring-2 focus:ring-orange-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-neutral-700 mb-1",children:"Sqm"}),e.jsx("input",{type:"number",name:"sqm",value:r.sqm??0,onChange:s.handleInputChange,className:"w-full px-4 py-2 border border-neutral-300 rounded-md bg-gray-100 focus:outline-none focus:ring-2 focus:ring-orange-500",disabled:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-neutral-700 mb-1",children:"Unit Type"}),e.jsxs("select",{name:"unit_type_id",value:r.unit_type_id??"",onChange:s.handleInputChange,className:"w-full px-4 py-2 border border-neutral-300 rounded-md bg-white focus:outline-none focus:ring-2 focus:ring-orange-500",children:[e.jsx("option",{value:"",children:"-- Select --"}),o.unitTypes.map(t=>e.jsx("option",{value:t.id,children:t.unit_type},t.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-neutral-700 mb-1",children:"Leasing Type"}),e.jsxs("select",{name:"leasing_type_id",value:r.leasing_type_id??"",onChange:s.handleInputChange,className:"w-full px-4 py-2 border border-neutral-300 rounded-md bg-white focus:outline-none focus:ring-2 focus:ring-orange-500",children:[e.jsx("option",{value:"",children:"-- Select --"}),o.leasingTypes.map(t=>e.jsx("option",{value:t.id,children:t.leasing_type},t.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-neutral-700 mb-1",children:"Unit Category"}),e.jsxs("select",{name:"unit_category_id",value:r.unit_category_id??"",onChange:s.handleInputChange,className:"w-full px-4 py-2 border border-neutral-300 rounded-md bg-white focus:outline-none focus:ring-2 focus:ring-orange-500",children:[e.jsx("option",{value:"",children:"-- Select --"}),o.unitCategories.map(t=>e.jsx("option",{value:t.id,children:t.unit_category},t.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-neutral-700 mb-1",children:"Category 2"}),e.jsxs("select",{name:"unit_category_2_id",value:r.unit_category_2_id??"",onChange:s.handleInputChange,className:"w-full px-4 py-2 border border-neutral-300 rounded-md bg-white focus:outline-none focus:ring-2 focus:ring-orange-500",children:[e.jsx("option",{value:"",children:"-- Select --"}),o.unitCategories2.map(t=>e.jsx("option",{value:t.id,children:t.unit_category_2},t.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-neutral-700 mb-1",children:"Category 3"}),e.jsxs("select",{name:"unit_category_3_id",value:r.unit_category_3_id??"",onChange:s.handleInputChange,className:"w-full px-4 py-2 border border-neutral-300 rounded-md bg-white focus:outline-none focus:ring-2 focus:ring-orange-500",children:[e.jsx("option",{value:"",children:"-- Select --"}),o.unitCategories3.map(t=>e.jsx("option",{value:t.id,children:t.unit_category_3},t.id))]})]})]})]})}),d&&e.jsxs("div",{className:"mt-4 px-6 text-sm text-red-600 bg-red-50 p-3 rounded-md",children:[e.jsx("strong",{children:"Error:"})," ",d]}),e.jsxs("div",{className:"mt-8 px-6 flex justify-end items-center",children:[e.jsx("button",{type:"button",onClick:a,className:"px-6 py-2 text-sm font-medium text-neutral-700 bg-white border border-neutral-300 rounded-full shadow-sm hover:bg-neutral-100 transition-colors duration-200",children:"Cancel"}),e.jsx("button",{type:"button",onClick:_,disabled:g,className:"ml-3 px-6 py-2 text-sm font-medium text-white bg-orange-600 rounded-full shadow-lg hover:bg-orange-700 disabled:bg-neutral-400 disabled:cursor-not-allowed transition-colors duration-200",children:g?"Saving...":"Save Changes"})]})]})]})})})})]})})}export{W as default};
