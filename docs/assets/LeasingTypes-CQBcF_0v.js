import{j as e,z as S,L as F,e as y,q as L,f as T,s as N,u as Z,g as H}from"./index-ChuUIRBG.js";import{b as s}from"./vendor-C5zIUBfc.js";import{u as J,F as K,a as M,b as V,R as X}from"./react-paginate-dLrqzcou.js";import{F as ee}from"./ExclamationTriangleIcon-DXl3jWQD.js";import{F as R,a as A}from"./TrashIcon-CqYIIe7G.js";import"./ui-DPhHsU_z.js";const te=({isOpen:f,onClose:n,onSuccess:h,leasingType:a})=>{const[c,m]=s.useState(""),[p,x]=s.useState(!1),[r,i]=s.useState("");s.useEffect(()=>{a&&m(a.leasing_type)},[a]);const b=async o=>{o.preventDefault();const l=c.trim();if(!l){i("Leasing type name cannot be empty.");return}if(!a||!a.id){i("Invalid leasing type data. Please try again.");return}x(!0),i("");try{const{data:d,error:u}=await N.from("leasing_types").select("id").ilike("leasing_type",l).neq("id",a.id).single();if(u&&u.code!=="PGRST116")throw u;if(d){i("This leasing type name has already been taken."),x(!1);return}const{data:j,error:g}=await N.from("leasing_types").update({leasing_type:l}).eq("id",a.id).select().single();if(g)throw g;h(),n()}catch(d){console.error("Error updating leasing type:",d),i("Failed to update leasing type. Please try again.")}finally{x(!1)}};return e.jsx(S,{appear:!0,show:f,as:s.Fragment,children:e.jsxs(F,{as:"div",className:"relative z-50",onClose:n,children:[e.jsx(y,{as:s.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:e.jsx("div",{className:"fixed inset-0 bg-black/70 backdrop-blur-sm"})}),e.jsx("div",{className:"fixed inset-0 overflow-y-auto",children:e.jsx("div",{className:"flex min-h-full items-center justify-center p-6 text-center",children:e.jsx(y,{as:s.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0 scale-95",enterTo:"opacity-100 scale-100",leave:"ease-in duration-200",leaveFrom:"opacity-100 scale-100",leaveTo:"opacity-0 scale-95",children:e.jsxs(L,{className:"w-full max-w-md transform overflow-hidden rounded-3xl bg-white p-8 text-left align-middle shadow-2xl transition-all",children:[e.jsx(T,{as:"h3",className:"text-xl font-semibold leading-6 text-gray-900",children:"Edit Leasing Type"}),e.jsxs("form",{onSubmit:b,className:"mt-6 space-y-5",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"edit-leasing-type",className:"block text-sm font-medium text-gray-700",children:"Leasing Type Name"}),e.jsx("input",{type:"text",id:"edit-leasing-type",value:c,onChange:o=>m(o.target.value),className:"mt-2 block w-full rounded-lg border border-gray-300 px-4 py-2 text-sm shadow-sm focus:border-orange-500 focus:ring-orange-500",placeholder:"e.g., Residential, Commercial"})]}),r&&e.jsx("p",{className:"text-sm text-red-600 font-medium",children:r}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t border-gray-100",children:[e.jsx("button",{type:"button",onClick:n,className:"inline-flex items-center justify-center rounded-md border border-gray-300 bg-white px-4 py-2 text-sm font-medium text-gray-700 hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-orange-500",children:"Cancel"}),e.jsx("button",{type:"submit",disabled:p,className:"inline-flex items-center justify-center rounded-md bg-orange-600 px-4 py-2 text-sm font-semibold text-white hover:bg-orange-700 focus:outline-none focus:ring-2 focus:ring-orange-500 disabled:opacity-50 disabled:cursor-not-allowed",children:p?"Saving...":"Save Changes"})]})]})]})})})})]})})},se=({isOpen:f,onClose:n,onConfirm:h,isDeleting:a,itemName:c})=>e.jsx(S,{appear:!0,show:f,as:s.Fragment,children:e.jsxs(F,{as:"div",className:"relative z-50",onClose:n,children:[e.jsx(y,{as:s.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:e.jsx("div",{className:"fixed inset-0 bg-black/60"})}),e.jsx("div",{className:"fixed inset-0 overflow-y-auto",children:e.jsx("div",{className:"flex min-h-full items-center justify-center p-4 text-center",children:e.jsx(y,{as:s.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0 scale-95",enterTo:"opacity-100 scale-100",leave:"ease-in duration-200",leaveFrom:"opacity-100 scale-100",leaveTo:"opacity-0 scale-95",children:e.jsxs(L,{className:"w-full max-w-md transform overflow-hidden rounded-2xl bg-white p-6 text-left align-middle shadow-xl transition-all",children:[e.jsxs("div",{className:"sm:flex sm:items-start",children:[e.jsx("div",{className:"mx-auto flex h-12 w-12 flex-shrink-0 items-center justify-center rounded-full bg-red-100 sm:mx-0 sm:h-10 sm:w-10",children:e.jsx(ee,{className:"h-6 w-6 text-red-600","aria-hidden":"true"})}),e.jsxs("div",{className:"mt-3 text-center sm:ml-4 sm:mt-0 sm:text-left",children:[e.jsx(T,{as:"h3",className:"text-lg font-semibold leading-6 text-gray-900",children:"Delete Leasing Type"}),e.jsx("div",{className:"mt-2",children:e.jsxs("p",{className:"text-sm text-gray-500",children:["Are you sure you want to delete"," ",e.jsx("strong",{className:"text-gray-800",children:c}),"? This action cannot be undone."]})})]})]}),e.jsxs("div",{className:"mt-5 sm:mt-4 sm:flex sm:flex-row-reverse",children:[e.jsx("button",{type:"button",disabled:a,className:"inline-flex w-full justify-center rounded-md bg-red-600 px-3 py-2 text-sm font-semibold text-white shadow-sm hover:bg-red-500 disabled:bg-red-300 sm:ml-3 sm:w-auto",onClick:h,children:a?"Deleting...":"Delete"}),e.jsx("button",{type:"button",className:"mt-3 inline-flex w-full justify-center rounded-md bg-white px-3 py-2 text-sm font-semibold text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 hover:bg-gray-50 sm:mt-0 sm:w-auto",onClick:n,disabled:a,children:"Cancel"})]})]})})})})]})}),ae=({isOpen:f,onClose:n,onSuccess:h})=>{const[a,c]=s.useState(""),[m,p]=s.useState(!1),[x,r]=s.useState(""),i=Z(o=>o.userProfile),b=async o=>{o.preventDefault();const l=a.trim();if(!l){r("Leasing type name cannot be empty.");return}if(!i){r("You must be logged in to add a leasing type.");return}p(!0),r("");try{const{data:d,error:u}=await N.from("leasing_types").select("leasing_type").ilike("leasing_type",l).single();if(u&&u.code!=="PGRST116")throw u;if(d){r("This leasing type name has already been taken."),p(!1);return}const{data:j,error:g}=await N.from("leasing_types").insert([{leasing_type:l,user_id:i.id}]).select().single();if(g)throw g;h(j),c(""),n()}catch(d){console.error("Error adding leasing type:",d),d.code==="23505"?r("This leasing type name has already been taken."):r("Failed to add leasing type. Please try again.")}finally{p(!1)}};return e.jsx(S,{appear:!0,show:f,as:s.Fragment,children:e.jsxs(F,{as:"div",className:"relative z-50",onClose:n,children:[e.jsx(y,{as:s.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:e.jsx("div",{className:"fixed inset-0 bg-black/70 backdrop-blur-sm"})}),e.jsx("div",{className:"fixed inset-0 overflow-y-auto",children:e.jsx("div",{className:"flex min-h-full items-center justify-center p-6 text-center",children:e.jsx(y,{as:s.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0 scale-95",enterTo:"opacity-100 scale-100",leave:"ease-in duration-200",leaveFrom:"opacity-100 scale-100",leaveTo:"opacity-0 scale-95",children:e.jsxs(L,{className:"w-full max-w-md transform overflow-hidden rounded-3xl bg-white p-8 text-left align-middle shadow-2xl transition-all",children:[e.jsx(T,{as:"h3",className:"text-xl font-semibold leading-6 text-gray-900",children:"Add New Leasing Type"}),e.jsxs("form",{onSubmit:b,className:"mt-6 space-y-5",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"leasing-type",className:"block text-sm font-medium text-gray-700",children:"Leasing Type Name"}),e.jsx("input",{type:"text",id:"leasing-type",value:a,onChange:o=>c(o.target.value),className:"mt-2 block w-full rounded-lg border border-gray-300 px-4 py-2 text-sm shadow-sm focus:border-orange-500 focus:ring-orange-500",placeholder:"e.g., Residential, Commercial, For Sale"})]}),x&&e.jsx("p",{className:"text-sm text-red-600 font-medium",children:x}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t border-gray-100",children:[e.jsx("button",{type:"button",onClick:n,className:"inline-flex items-center justify-center rounded-md border border-gray-300 bg-white px-4 py-2 text-sm font-medium text-gray-700 hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-orange-500",children:"Cancel"}),e.jsx("button",{type:"submit",disabled:m,className:"inline-flex items-center justify-center rounded-md bg-orange-600 px-4 py-2 text-sm font-semibold text-white hover:bg-orange-700 focus:outline-none focus:ring-2 focus:ring-orange-500 disabled:opacity-50 disabled:cursor-not-allowed",children:m?"Adding...":"Add Leasing Type"})]})]})]})})})})]})})},ce=()=>{const[f,n]=s.useState(!1),[h,a]=s.useState(!1),[c,m]=s.useState(!1),[p,x]=s.useState(!1),[r,i]=s.useState(null),[b,o]=s.useState(!1),{data:l,totalCount:d,isLoading:u,error:j,mutate:g,currentPage:w,setCurrentPage:C,pageCount:D,pageSize:z,searchTerm:O,setSearchTerm:_,activeSearchTerm:v,handleSearch:$,clearSearch:I}=J({tableName:"leasing_types",selectQuery:`
      id,
      leasing_type,
      created_at,
      profiles (first_name, last_name)
    `,searchColumn:"leasing_type",initialPageSize:5});s.useEffect(()=>{const t=()=>o(window.innerWidth<768);return t(),window.addEventListener("resize",t),()=>window.removeEventListener("resize",t)},[]);const q=t=>{C(t.selected+1)},U=()=>{n(!1),g(),(w!==1||v)&&(C(1),_(""),setActiveSearchTerm(""))},E=t=>{i(t),a(!0)},G=()=>{a(!1),i(null),g()},P=t=>{i(t),m(!0)},Q=async()=>{if(r){x(!0);try{const{error:t}=await N.from("leasing_types").delete().eq("id",r.id);if(t)throw t;l.length===1&&w>1?C(w-1):g()}catch(t){console.error("Failed to delete leasing type:",t)}finally{x(!1),m(!1),i(null)}}},Y=()=>e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Leasing Type"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Created By"}),e.jsx("th",{scope:"col",className:"relative px-6 py-3",children:e.jsx("span",{className:"sr-only",children:"Actions"})})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:l.map(t=>{const k=t.profiles?`${t.profiles.first_name} ${t.profiles.last_name}`:"Unknown User";return e.jsxs("tr",{children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:t.leasing_type}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:k}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium space-x-2",children:[e.jsx("button",{onClick:()=>E(t),className:"text-orange-600 hover:text-orange-900 p-1",children:e.jsx(R,{className:"h-5 w-5"})}),e.jsx("button",{onClick:()=>P(t),className:"text-red-600 hover:text-red-900 p-1",children:e.jsx(A,{className:"h-5 w-5"})})]})]},t.id)})})]})}),B=()=>e.jsx("div",{className:"space-y-4",children:l.map(t=>{const k=t.profiles?`${t.profiles.first_name} ${t.profiles.last_name}`:"Unknown User";return e.jsx("div",{className:"bg-white p-4 rounded-lg shadow-sm border border-gray-200",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:t.leasing_type}),e.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:["Created by: ",k]})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("button",{onClick:()=>E(t),className:"text-orange-600 hover:text-orange-900 p-1",children:e.jsx(R,{className:"h-5 w-5"})}),e.jsx("button",{onClick:()=>P(t),className:"text-red-600 hover:text-red-900 p-1",children:e.jsx(A,{className:"h-5 w-5"})})]})]})},t.id)})}),W=()=>u&&!d?e.jsx("div",{className:"flex justify-center py-20",children:e.jsx(H,{})}):j?e.jsx("div",{className:"text-center py-10 text-red-500",children:j.message}):l.length===0?e.jsxs("div",{className:"text-center py-10 text-gray-500",children:[e.jsx("h4",{className:"font-semibold",children:v?"No Results Found":"No Leasing Types Yet"}),e.jsx("p",{children:v?"Try a different search term or clear the search.":'Click "Add New" to get started.'})]}):b?B():Y();return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-6 w-full mx-auto p-4 md:p-6 max-w-4xl",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Manage Leasing Types"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Configure your property leasing types here."})]}),e.jsxs("button",{onClick:()=>n(!0),className:"inline-flex items-center justify-center gap-x-2 bg-orange-600 hover:bg-orange-700 text-white px-4 py-2 rounded-lg text-sm font-medium transition-colors focus:outline-none focus:ring-2 focus:ring-orange-500 focus:ring-offset-2",children:[e.jsx(K,{className:"h-5 w-5"}),e.jsx("span",{className:"sm:inline",children:"Add New"})]})]}),e.jsxs("form",{onSubmit:$,className:"flex items-center gap-2 w-full",children:[e.jsxs("div",{className:"relative flex-grow w-full",children:[e.jsx("div",{className:"pointer-events-none absolute inset-y-0 left-0 flex items-center pl-3",children:e.jsx(M,{className:"h-5 w-5 text-gray-400"})}),e.jsx("input",{type:"text",value:O,onChange:t=>_(t.target.value),placeholder:"Search by leasing type...",className:"block w-full rounded-md border-0 py-2 pl-10 text-gray-900 ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-orange-600 sm:text-sm"})]}),e.jsx("button",{type:"submit",className:"hidden sm:flex items-center justify-center px-4 py-2 text-sm font-medium text-white bg-gray-800 rounded-md hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500",children:"Search"}),e.jsx("button",{type:"submit",className:"sm:hidden p-2 text-white bg-gray-800 rounded-md hover:bg-gray-700","aria-label":"Search",children:e.jsx(M,{className:"h-5 w-5"})}),v&&e.jsx("button",{type:"button",onClick:I,className:"p-2 text-sm font-medium text-gray-600 bg-gray-100 rounded-md hover:bg-gray-200","aria-label":"Clear search",children:e.jsx(V,{className:"h-5 w-5"})})]}),e.jsxs("div",{className:"bg-white shadow-sm ring-1 ring-gray-900/5 rounded-lg",children:[W(),d>z&&e.jsx("div",{className:"p-6 border-t border-gray-200",children:e.jsx(X,{breakLabel:"...",nextLabel:"›",onPageChange:q,pageRangeDisplayed:3,pageCount:D,previousLabel:"‹",renderOnZeroPageCount:null,forcePage:w-1,containerClassName:"flex items-center justify-center gap-2 text-base font-medium",pageClassName:"",pageLinkClassName:"w-10 h-10 flex items-center justify-center rounded-lg border border-gray-300 text-gray-900 hover:bg-gray-100 transition duration-200 cursor-pointer",activeClassName:"",activeLinkClassName:"bg-orange-500 text-white border-orange-500 hover:bg-orange-600",previousClassName:"",previousLinkClassName:"w-10 h-10 flex items-center justify-center rounded-lg border border-gray-300 text-gray-900 hover:bg-gray-100 transition duration-200 cursor-pointer",nextClassName:"",nextLinkClassName:"w-10 h-10 flex items-center justify-center rounded-lg border border-gray-300 text-gray-900 hover:bg-gray-100 transition duration-200 cursor-pointer",disabledClassName:"opacity-50 cursor-not-allowed",breakClassName:"",breakLinkClassName:"w-10 h-10 flex items-center justify-center rounded-lg border border-gray-300 text-gray-400"})})]})]}),e.jsx(ae,{isOpen:f,onClose:()=>n(!1),onSuccess:U}),r&&e.jsxs(e.Fragment,{children:[e.jsx(te,{isOpen:h,onClose:()=>a(!1),onSuccess:G,leasingType:r}),e.jsx(se,{isOpen:c,onClose:()=>m(!1),onConfirm:Q,isDeleting:p,itemName:r.leasing_type})]})]})};export{ce as default};
