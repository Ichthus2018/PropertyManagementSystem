import{j as e,z as S,L as T,e as y,q as F,f as U,s as N,u as Z,g as H}from"./index-BU3CQqfv.js";import{b as s}from"./vendor-D0onPmP6.js";import{F as J,a as P,b as K,R as Q}from"./react-paginate-AX4tIbqh.js";import{F as X}from"./ExclamationTriangleIcon-BI5VgTw-.js";import{F as A,a as L}from"./TrashIcon-Dlbufv-M.js";import"./ui-CRpVhgKF.js";const ee=({isOpen:f,onClose:n,onSuccess:h,unit:a})=>{const[c,m]=s.useState(""),[g,u]=s.useState(!1),[r,i]=s.useState("");s.useEffect(()=>{a&&m(a.unit_type)},[a]);const b=async o=>{o.preventDefault();const l=c.trim();if(!l){i("Unit type name cannot be empty.");return}if(!a||!a.id){i("Invalid unit data. Please try again.");return}u(!0),i("");try{const{data:d,error:x}=await N.from("unit_types").select("id").ilike("unit_type",l).neq("id",a.id).single();if(x&&x.code!=="PGRST116")throw x;if(d){i("This unit type name has already been taken."),u(!1);return}const{data:j,error:p}=await N.from("unit_types").update({unit_type:l}).eq("id",a.id).select().single();if(p)throw p;h(),n()}catch(d){console.error("Error updating unit type:",d),i("Failed to update unit type. Please try again.")}finally{u(!1)}};return e.jsx(S,{appear:!0,show:f,as:s.Fragment,children:e.jsxs(T,{as:"div",className:"relative z-50",onClose:n,children:[e.jsx(y,{as:s.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:e.jsx("div",{className:"fixed inset-0 bg-black/70 backdrop-blur-sm"})}),e.jsx("div",{className:"fixed inset-0 overflow-y-auto",children:e.jsx("div",{className:"flex min-h-full items-center justify-center p-6 text-center",children:e.jsx(y,{as:s.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0 scale-95",enterTo:"opacity-100 scale-100",leave:"ease-in duration-200",leaveFrom:"opacity-100 scale-100",leaveTo:"opacity-0 scale-95",children:e.jsxs(F,{className:"w-full max-w-md transform overflow-hidden rounded-3xl bg-white p-8 text-left align-middle shadow-2xl transition-all",children:[e.jsx(U,{as:"h3",className:"text-xl font-semibold leading-6 text-gray-900",children:"Edit Unit Type"}),e.jsxs("form",{onSubmit:b,className:"mt-6 space-y-5",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"edit-unit-type",className:"block text-sm font-medium text-gray-700",children:"Unit Type Name"}),e.jsx("input",{type:"text",id:"edit-unit-type",value:c,onChange:o=>m(o.target.value),className:"mt-2 block w-full rounded-lg border border-gray-300 px-4 py-2 text-sm shadow-sm focus:border-orange-500 focus:ring-orange-500",placeholder:"e.g., Studio, Apartment"})]}),r&&e.jsx("p",{className:"text-sm text-red-600 font-medium",children:r}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t border-gray-100",children:[e.jsx("button",{type:"button",onClick:n,className:"inline-flex items-center justify-center rounded-md border border-gray-300 bg-white px-4 py-2 text-sm font-medium text-gray-700 hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-orange-500",children:"Cancel"}),e.jsx("button",{type:"submit",disabled:g,className:"inline-flex items-center justify-center rounded-md bg-orange-600 px-4 py-2 text-sm font-semibold text-white hover:bg-orange-700 focus:outline-none focus:ring-2 focus:ring-orange-500 disabled:opacity-50 disabled:cursor-not-allowed",children:g?"Saving...":"Save Changes"})]})]})]})})})})]})})},te=({isOpen:f,onClose:n,onConfirm:h,isDeleting:a,itemName:c})=>e.jsx(S,{appear:!0,show:f,as:s.Fragment,children:e.jsxs(T,{as:"div",className:"relative z-50",onClose:n,children:[e.jsx(y,{as:s.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:e.jsx("div",{className:"fixed inset-0 bg-black/60"})}),e.jsx("div",{className:"fixed inset-0 overflow-y-auto",children:e.jsx("div",{className:"flex min-h-full items-center justify-center p-4 text-center",children:e.jsx(y,{as:s.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0 scale-95",enterTo:"opacity-100 scale-100",leave:"ease-in duration-200",leaveFrom:"opacity-100 scale-100",leaveTo:"opacity-0 scale-95",children:e.jsxs(F,{className:"w-full max-w-md transform overflow-hidden rounded-2xl bg-white p-6 text-left align-middle shadow-xl transition-all",children:[e.jsxs("div",{className:"sm:flex sm:items-start",children:[e.jsx("div",{className:"mx-auto flex h-12 w-12 flex-shrink-0 items-center justify-center rounded-full bg-red-100 sm:mx-0 sm:h-10 sm:w-10",children:e.jsx(X,{className:"h-6 w-6 text-red-600","aria-hidden":"true"})}),e.jsxs("div",{className:"mt-3 text-center sm:ml-4 sm:mt-0 sm:text-left",children:[e.jsx(U,{as:"h3",className:"text-lg font-semibold leading-6 text-gray-900",children:"Delete Unit Type"}),e.jsx("div",{className:"mt-2",children:e.jsxs("p",{className:"text-sm text-gray-500",children:["Are you sure you want to delete"," ",e.jsx("strong",{className:"text-gray-800",children:c}),"? This action cannot be undone."]})})]})]}),e.jsxs("div",{className:"mt-5 sm:mt-4 sm:flex sm:flex-row-reverse",children:[e.jsx("button",{type:"button",disabled:a,className:"inline-flex w-full justify-center rounded-md bg-red-600 px-3 py-2 text-sm font-semibold text-white shadow-sm hover:bg-red-500 disabled:bg-red-300 sm:ml-3 sm:w-auto",onClick:h,children:a?"Deleting...":"Delete"}),e.jsx("button",{type:"button",className:"mt-3 inline-flex w-full justify-center rounded-md bg-white px-3 py-2 text-sm font-semibold text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 hover:bg-gray-50 sm:mt-0 sm:w-auto",onClick:n,disabled:a,children:"Cancel"})]})]})})})})]})}),se=({isOpen:f,onClose:n,onSuccess:h})=>{const[a,c]=s.useState(""),[m,g]=s.useState(!1),[u,r]=s.useState(""),i=Z(o=>o.userProfile),b=async o=>{o.preventDefault();const l=a.trim();if(!l){r("Unit type name cannot be empty.");return}if(!i){r("You must be logged in to add a unit type.");return}g(!0),r("");try{const{data:d,error:x}=await N.from("unit_types").select("unit_type").ilike("unit_type",l).single();if(x&&x.code!=="PGRST116")throw x;if(d){r("This unit type name has already been taken."),g(!1);return}const{data:j,error:p}=await N.from("unit_types").insert([{unit_type:l,user_id:i.id}]).select().single();if(p)throw p;h(j),c(""),n()}catch(d){console.error("Error adding unit type:",d),d.code==="23505"?r("This unit type name has already been taken."):r("Failed to add unit type. Please try again.")}finally{g(!1)}};return e.jsx(S,{appear:!0,show:f,as:s.Fragment,children:e.jsxs(T,{as:"div",className:"relative z-50",onClose:n,children:[e.jsx(y,{as:s.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:e.jsx("div",{className:"fixed inset-0 bg-black/70 backdrop-blur-sm"})}),e.jsx("div",{className:"fixed inset-0 overflow-y-auto",children:e.jsx("div",{className:"flex min-h-full items-center justify-center p-6 text-center",children:e.jsx(y,{as:s.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0 scale-95",enterTo:"opacity-100 scale-100",leave:"ease-in duration-200",leaveFrom:"opacity-100 scale-100",leaveTo:"opacity-0 scale-95",children:e.jsxs(F,{className:"w-full max-w-md transform overflow-hidden rounded-3xl bg-white p-8 text-left align-middle shadow-2xl transition-all",children:[e.jsx(U,{as:"h3",className:"text-xl font-semibold leading-6 text-gray-900",children:"Add New Unit Type"}),e.jsxs("form",{onSubmit:b,className:"mt-6 space-y-5",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"unit-type",className:"block text-sm font-medium text-gray-700",children:"Unit Type Name"}),e.jsx("input",{type:"text",id:"unit-type",value:a,onChange:o=>c(o.target.value),className:"mt-2 block w-full rounded-lg border border-gray-300 px-4 py-2 text-sm shadow-sm focus:border-orange-500 focus:ring-orange-500",placeholder:"e.g., Apartment, Villa, Studio"})]}),u&&e.jsx("p",{className:"text-sm text-red-600 font-medium",children:u}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t border-gray-100",children:[e.jsx("button",{type:"button",onClick:n,className:"inline-flex items-center justify-center rounded-md border border-gray-300 bg-white px-4 py-2 text-sm font-medium text-gray-700 hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-orange-500",children:"Cancel"}),e.jsx("button",{type:"submit",disabled:m,className:"inline-flex items-center justify-center rounded-md bg-orange-600 px-4 py-2 text-sm font-semibold text-white hover:bg-orange-700 focus:outline-none focus:ring-2 focus:ring-orange-500 disabled:opacity-50 disabled:cursor-not-allowed",children:m?"Adding...":"Add Unit Type"})]})]})]})})})})]})})},de=()=>{const[f,n]=s.useState(!1),[h,a]=s.useState(!1),[c,m]=s.useState(!1),[g,u]=s.useState(!1),[r,i]=s.useState(null),[b,o]=s.useState(!1),{data:l,totalCount:d,isLoading:x,error:j,mutate:p,currentPage:w,setCurrentPage:k,pageCount:R,pageSize:D,searchTerm:O,setSearchTerm:E,activeSearchTerm:v,handleSearch:$,clearSearch:z}={};s.useEffect(()=>{const t=()=>o(window.innerWidth<768);return t(),window.addEventListener("resize",t),()=>window.removeEventListener("resize",t)},[]);const I=t=>{k(t.selected+1)},q=()=>{n(!1),p(),(w!==1||v)&&(k(1),E(""),setActiveSearchTerm(""))},_=t=>{i(t),a(!0)},G=()=>{a(!1),i(null),p()},M=t=>{i(t),m(!0)},Y=async()=>{if(r){u(!0);try{const{error:t}=await N.from("unit_types").delete().eq("id",r.id);if(t)throw t;l.length===1&&w>1?k(w-1):p()}catch(t){console.error("Failed to delete unit type:",t)}finally{u(!1),m(!1),i(null)}}},B=()=>e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Unit Type"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Created By"}),e.jsx("th",{scope:"col",className:"relative px-6 py-3",children:e.jsx("span",{className:"sr-only",children:"Actions"})})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:l.map(t=>{const C=t.profiles?`${t.profiles.first_name} ${t.profiles.last_name}`:"Unknown User";return e.jsxs("tr",{children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:t.unit_type}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:C}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium space-x-2",children:[e.jsx("button",{onClick:()=>_(t),className:"text-orange-600 hover:text-orange-900 p-1",children:e.jsx(A,{className:"h-5 w-5"})}),e.jsx("button",{onClick:()=>M(t),className:"text-red-600 hover:text-red-900 p-1",children:e.jsx(L,{className:"h-5 w-5"})})]})]},t.id)})})]})}),V=()=>e.jsx("div",{className:"space-y-4",children:l.map(t=>{const C=t.profiles?`${t.profiles.first_name} ${t.profiles.last_name}`:"Unknown User";return e.jsx("div",{className:"bg-white p-4 rounded-lg shadow-sm border border-gray-200",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:t.unit_type}),e.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:["Created by: ",C]})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("button",{onClick:()=>_(t),className:"text-orange-600 hover:text-orange-900 p-1",children:e.jsx(A,{className:"h-5 w-5"})}),e.jsx("button",{onClick:()=>M(t),className:"text-red-600 hover:text-red-900 p-1",children:e.jsx(L,{className:"h-5 w-5"})})]})]})},t.id)})}),W=()=>x&&!d?e.jsx("div",{className:"flex justify-center py-20",children:e.jsx(H,{})}):j?e.jsx("div",{className:"text-center py-10 text-red-500",children:j.message}):l.length===0?e.jsxs("div",{className:"text-center py-10 text-gray-500",children:[e.jsx("h4",{className:"font-semibold",children:v?"No Results Found":"No Unit Types Yet"}),e.jsx("p",{children:v?"Try a different search term or clear the search.":'Click "Add New" to get started.'})]}):b?V():B();return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-6 w-full mx-auto p-4 md:p-6 max-w-4xl",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Manage Unit Types"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Configure your property unit types here."})]}),e.jsxs("button",{onClick:()=>n(!0),className:"inline-flex items-center justify-center gap-x-2 bg-orange-600 hover:bg-orange-700 text-white px-4 py-2 rounded-lg text-sm font-medium transition-colors focus:outline-none focus:ring-2 focus:ring-orange-500 focus:ring-offset-2",children:[e.jsx(J,{className:"h-5 w-5"}),e.jsx("span",{className:"sm:inline",children:"Add New"})]})]}),e.jsxs("form",{onSubmit:$,className:"flex items-center gap-2 w-full",children:[e.jsxs("div",{className:"relative flex-grow w-full",children:[e.jsx("div",{className:"pointer-events-none absolute inset-y-0 left-0 flex items-center pl-3",children:e.jsx(P,{className:"h-5 w-5 text-gray-400"})}),e.jsx("input",{type:"text",value:O,onChange:t=>E(t.target.value),placeholder:"Search by unit type...",className:"block w-full rounded-md border-0 py-2 pl-10 text-gray-900 ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-orange-600 sm:text-sm"})]}),e.jsx("button",{type:"submit",className:"hidden sm:flex items-center justify-center px-4 py-2 text-sm font-medium text-white bg-gray-800 rounded-md hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500",children:"Search"}),e.jsx("button",{type:"submit",className:"sm:hidden p-2 text-white bg-gray-800 rounded-md hover:bg-gray-700","aria-label":"Search",children:e.jsx(P,{className:"h-5 w-5"})}),v&&e.jsx("button",{type:"button",onClick:z,className:"p-2 text-sm font-medium text-gray-600 bg-gray-100 rounded-md hover:bg-gray-200","aria-label":"Clear search",children:e.jsx(K,{className:"h-5 w-5"})})]}),e.jsxs("div",{className:"bg-white shadow-sm ring-1 ring-gray-900/5 rounded-lg",children:[W(),d>D&&e.jsx("div",{className:"p-6 border-t border-gray-200",children:e.jsx(Q,{breakLabel:"...",nextLabel:"›",onPageChange:I,pageRangeDisplayed:3,pageCount:R,previousLabel:"‹",renderOnZeroPageCount:null,forcePage:w-1,containerClassName:"flex items-center justify-center gap-2 text-base font-medium",pageClassName:"",pageLinkClassName:"w-10 h-10 flex items-center justify-center rounded-lg border border-gray-300 text-gray-900 hover:bg-gray-100 transition duration-200 cursor-pointer",activeClassName:"",activeLinkClassName:"bg-orange-500 text-white border-orange-500 hover:bg-orange-600",previousClassName:"",previousLinkClassName:"w-10 h-10 flex items-center justify-center rounded-lg border border-gray-300 text-gray-900 hover:bg-gray-100 transition duration-200 cursor-pointer",nextClassName:"",nextLinkClassName:"w-10 h-10 flex items-center justify-center rounded-lg border border-gray-300 text-gray-900 hover:bg-gray-100 transition duration-200 cursor-pointer",disabledClassName:"opacity-50 cursor-not-allowed",breakClassName:"",breakLinkClassName:"w-10 h-10 flex items-center justify-center rounded-lg border border-gray-300 text-gray-400"})})]})]}),e.jsx(se,{isOpen:f,onClose:()=>n(!1),onSuccess:q}),r&&e.jsxs(e.Fragment,{children:[e.jsx(ee,{isOpen:h,onClose:()=>a(!1),onSuccess:G,unit:r}),e.jsx(te,{isOpen:c,onClose:()=>m(!1),onConfirm:Y,isDeleting:g,itemName:r.unit_type})]})]})};export{de as default};
