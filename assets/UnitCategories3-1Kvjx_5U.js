import{j as e,z as k,L as _,e as p,q as F,f as T,s as N,u as Z,g as H}from"./index-BU3CQqfv.js";import{b as s}from"./vendor-D0onPmP6.js";import{F as J,a as M,b as K,R as V}from"./react-paginate-AX4tIbqh.js";import{u as X}from"./useSupabaseQuery-DlxLBHLb.js";import{F as ee}from"./ExclamationTriangleIcon-BI5VgTw-.js";import{F as L,a as A}from"./TrashIcon-Dlbufv-M.js";import"./ui-CRpVhgKF.js";const te=({isOpen:h,onClose:n,onSuccess:y,category:a})=>{const[c,m]=s.useState(""),[f,u]=s.useState(!1),[r,i]=s.useState("");s.useEffect(()=>{a&&m(a.unit_category_3)},[a]);const b=async l=>{l.preventDefault();const o=c.trim();if(!o){i("Unit category 3 name cannot be empty.");return}if(!a||!a.id){i("Invalid unit category 3 data. Please try again.");return}u(!0),i("");try{const{data:d,error:x}=await N.from("unit_categories_3").select("id").ilike("unit_category_3",o).neq("id",a.id).single();if(x&&x.code!=="PGRST116")throw x;if(d){i("This unit category 3 name has already been taken."),u(!1);return}const{data:j,error:g}=await N.from("unit_categories_3").update({unit_category_3:o}).eq("id",a.id).select().single();if(g)throw g;y(),n()}catch(d){console.error("Error updating unit category 3:",d),i("Failed to update unit category 3. Please try again.")}finally{u(!1)}};return e.jsx(k,{appear:!0,show:h,as:s.Fragment,children:e.jsxs(_,{as:"div",className:"relative z-50",onClose:n,children:[e.jsx(p,{as:s.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:e.jsx("div",{className:"fixed inset-0 bg-black/70 backdrop-blur-sm"})}),e.jsx("div",{className:"fixed inset-0 overflow-y-auto",children:e.jsx("div",{className:"flex min-h-full items-center justify-center p-6 text-center",children:e.jsx(p,{as:s.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0 scale-95",enterTo:"opacity-100 scale-100",leave:"ease-in duration-200",leaveFrom:"opacity-100 scale-100",leaveTo:"opacity-0 scale-95",children:e.jsxs(F,{className:"w-full max-w-md transform overflow-hidden rounded-3xl bg-white p-8 text-left align-middle shadow-2xl transition-all",children:[e.jsx(T,{as:"h3",className:"text-xl font-semibold leading-6 text-gray-900",children:"Edit Unit Category 3"}),e.jsxs("form",{onSubmit:b,className:"mt-6 space-y-5",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"edit-unit-category3",className:"block text-sm font-medium text-gray-700",children:"Unit Category 3 Name"}),e.jsx("input",{type:"text",id:"edit-unit-category3",value:c,onChange:l=>m(l.target.value),className:"mt-2 block w-full rounded-lg border border-gray-300 px-4 py-2 text-sm shadow-sm focus:border-orange-500 focus:ring-orange-500",placeholder:"e.g., Gold, Silver"})]}),r&&e.jsx("p",{className:"text-sm text-red-600 font-medium",children:r}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t border-gray-100",children:[e.jsx("button",{type:"button",onClick:n,className:"inline-flex items-center justify-center rounded-md border border-gray-300 bg-white px-4 py-2 text-sm font-medium text-gray-700 hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-orange-500",children:"Cancel"}),e.jsx("button",{type:"submit",disabled:f,className:"inline-flex items-center justify-center rounded-md bg-orange-600 px-4 py-2 text-sm font-semibold text-white hover:bg-orange-700 focus:outline-none focus:ring-2 focus:ring-orange-500 disabled:opacity-50 disabled:cursor-not-allowed",children:f?"Saving...":"Save Changes"})]})]})]})})})})]})})},se=({isOpen:h,onClose:n,onConfirm:y,isDeleting:a,itemName:c})=>e.jsx(k,{appear:!0,show:h,as:s.Fragment,children:e.jsxs(_,{as:"div",className:"relative z-50",onClose:n,children:[e.jsx(p,{as:s.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:e.jsx("div",{className:"fixed inset-0 bg-black/60"})}),e.jsx("div",{className:"fixed inset-0 overflow-y-auto",children:e.jsx("div",{className:"flex min-h-full items-center justify-center p-4 text-center",children:e.jsx(p,{as:s.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0 scale-95",enterTo:"opacity-100 scale-100",leave:"ease-in duration-200",leaveFrom:"opacity-100 scale-100",leaveTo:"opacity-0 scale-95",children:e.jsxs(F,{className:"w-full max-w-md transform overflow-hidden rounded-2xl bg-white p-6 text-left align-middle shadow-xl transition-all",children:[e.jsxs("div",{className:"sm:flex sm:items-start",children:[e.jsx("div",{className:"mx-auto flex h-12 w-12 flex-shrink-0 items-center justify-center rounded-full bg-red-100 sm:mx-0 sm:h-10 sm:w-10",children:e.jsx(ee,{className:"h-6 w-6 text-red-600","aria-hidden":"true"})}),e.jsxs("div",{className:"mt-3 text-center sm:ml-4 sm:mt-0 sm:text-left",children:[e.jsx(T,{as:"h3",className:"text-lg font-semibold leading-6 text-gray-900",children:"Delete Unit Category 3"}),e.jsx("div",{className:"mt-2",children:e.jsxs("p",{className:"text-sm text-gray-500",children:["Are you sure you want to delete"," ",e.jsx("strong",{className:"text-gray-800",children:c}),"? This action cannot be undone."]})})]})]}),e.jsxs("div",{className:"mt-5 sm:mt-4 sm:flex sm:flex-row-reverse",children:[e.jsx("button",{type:"button",disabled:a,className:"inline-flex w-full justify-center rounded-md bg-red-600 px-3 py-2 text-sm font-semibold text-white shadow-sm hover:bg-red-500 disabled:bg-red-300 sm:ml-3 sm:w-auto",onClick:y,children:a?"Deleting...":"Delete"}),e.jsx("button",{type:"button",className:"mt-3 inline-flex w-full justify-center rounded-md bg-white px-3 py-2 text-sm font-semibold text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 hover:bg-gray-50 sm:mt-0 sm:w-auto",onClick:n,disabled:a,children:"Cancel"})]})]})})})})]})}),ae=({isOpen:h,onClose:n,onSuccess:y})=>{const[a,c]=s.useState(""),[m,f]=s.useState(!1),[u,r]=s.useState(""),i=Z(l=>l.userProfile),b=async l=>{l.preventDefault();const o=a.trim();if(!o){r("Unit category 3 name cannot be empty.");return}if(!i){r("You must be logged in to add a unit category 3.");return}f(!0),r("");try{const{data:d,error:x}=await N.from("unit_categories_3").select("unit_category_3").ilike("unit_category_3",o).single();if(x&&x.code!=="PGRST116")throw x;if(d){r("This unit category 3 name has already been taken."),f(!1);return}const{data:j,error:g}=await N.from("unit_categories_3").insert([{unit_category_3:o,user_id:i.id}]).select().single();if(g)throw g;y(j),c(""),n()}catch(d){console.error("Error adding unit category 3:",d),d.code==="23505"?r("This unit category 3 name has already been taken."):r("Failed to add unit category 3. Please try again.")}finally{f(!1)}};return e.jsx(k,{appear:!0,show:h,as:s.Fragment,children:e.jsxs(_,{as:"div",className:"relative z-50",onClose:n,children:[e.jsx(p,{as:s.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:e.jsx("div",{className:"fixed inset-0 bg-black/70 backdrop-blur-sm"})}),e.jsx("div",{className:"fixed inset-0 overflow-y-auto",children:e.jsx("div",{className:"flex min-h-full items-center justify-center p-6 text-center",children:e.jsx(p,{as:s.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0 scale-95",enterTo:"opacity-100 scale-100",leave:"ease-in duration-200",leaveFrom:"opacity-100 scale-100",leaveTo:"opacity-0 scale-95",children:e.jsxs(F,{className:"w-full max-w-md transform overflow-hidden rounded-3xl bg-white p-8 text-left align-middle shadow-2xl transition-all",children:[e.jsx(T,{as:"h3",className:"text-xl font-semibold leading-6 text-gray-900",children:"Add New Unit Category 3"}),e.jsxs("form",{onSubmit:b,className:"mt-6 space-y-5",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"unit-category3",className:"block text-sm font-medium text-gray-700",children:"Unit Category 3 Name"}),e.jsx("input",{type:"text",id:"unit-category3",value:a,onChange:l=>c(l.target.value),className:"mt-2 block w-full rounded-lg border border-gray-300 px-4 py-2 text-sm shadow-sm focus:border-orange-500 focus:ring-orange-500",placeholder:"e.g., Gold, Silver, Bronze"})]}),u&&e.jsx("p",{className:"text-sm text-red-600 font-medium",children:u}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t border-gray-100",children:[e.jsx("button",{type:"button",onClick:n,className:"inline-flex items-center justify-center rounded-md border border-gray-300 bg-white px-4 py-2 text-sm font-medium text-gray-700 hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-orange-500",children:"Cancel"}),e.jsx("button",{type:"submit",disabled:m,className:"inline-flex items-center justify-center rounded-md bg-orange-600 px-4 py-2 text-sm font-semibold text-white hover:bg-orange-700 focus:outline-none focus:ring-2 focus:ring-orange-500 disabled:opacity-50 disabled:cursor-not-allowed",children:m?"Adding...":"Add Unit Category 3"})]})]})]})})})})]})})},me=()=>{const[h,n]=s.useState(!1),[y,a]=s.useState(!1),[c,m]=s.useState(!1),[f,u]=s.useState(!1),[r,i]=s.useState(null),[b,l]=s.useState(!1),{data:o,totalCount:d,isLoading:x,error:j,mutate:g,currentPage:v,setCurrentPage:C,pageCount:R,pageSize:z,searchTerm:D,setSearchTerm:U,activeSearchTerm:w,handleSearch:O,clearSearch:$}=X({tableName:"unit_categories_3",selectQuery:`
      id,
      unit_category_3,
      created_at,
      profiles (first_name, last_name)
    `,searchColumn:"unit_category_3",initialPageSize:5});s.useEffect(()=>{const t=()=>l(window.innerWidth<768);return t(),window.addEventListener("resize",t),()=>window.removeEventListener("resize",t)},[]);const I=t=>{C(t.selected+1)},q=()=>{n(!1),g(),(v!==1||w)&&(C(1),U(""),setActiveSearchTerm(""))},E=t=>{i(t),a(!0)},G=()=>{a(!1),i(null),g()},P=t=>{i(t),m(!0)},B=async()=>{if(r){u(!0);try{const{error:t}=await N.from("unit_categories_3").delete().eq("id",r.id);if(t)throw t;o.length===1&&v>1?C(v-1):g()}catch(t){console.error("Failed to delete unit category 3:",t)}finally{u(!1),m(!1),i(null)}}},Q=()=>e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Unit Category 3"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Created By"}),e.jsx("th",{scope:"col",className:"relative px-6 py-3",children:e.jsx("span",{className:"sr-only",children:"Actions"})})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:o.map(t=>{const S=t.profiles?`${t.profiles.first_name} ${t.profiles.last_name}`:"Unknown User";return e.jsxs("tr",{children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:t.unit_category_3}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:S}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium space-x-2",children:[e.jsx("button",{onClick:()=>E(t),className:"text-orange-600 hover:text-orange-900 p-1",children:e.jsx(L,{className:"h-5 w-5"})}),e.jsx("button",{onClick:()=>P(t),className:"text-red-600 hover:text-red-900 p-1",children:e.jsx(A,{className:"h-5 w-5"})})]})]},t.id)})})]})}),Y=()=>e.jsx("div",{className:"space-y-4",children:o.map(t=>{const S=t.profiles?`${t.profiles.first_name} ${t.profiles.last_name}`:"Unknown User";return e.jsx("div",{className:"bg-white p-4 rounded-lg shadow-sm border border-gray-200",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:t.unit_category_3}),e.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:["Created by: ",S]})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("button",{onClick:()=>E(t),className:"text-orange-600 hover:text-orange-900 p-1",children:e.jsx(L,{className:"h-5 w-5"})}),e.jsx("button",{onClick:()=>P(t),className:"text-red-600 hover:text-red-900 p-1",children:e.jsx(A,{className:"h-5 w-5"})})]})]})},t.id)})}),W=()=>x&&!d?e.jsx("div",{className:"flex justify-center py-20",children:e.jsx(H,{})}):j?e.jsx("div",{className:"text-center py-10 text-red-500",children:j.message}):o.length===0?e.jsxs("div",{className:"text-center py-10 text-gray-500",children:[e.jsx("h4",{className:"font-semibold",children:w?"No Results Found":"No Unit Categories 3 Yet"}),e.jsx("p",{children:w?"Try a different search term or clear the search.":'Click "Add New" to get started.'})]}):b?Y():Q();return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-6 w-full mx-auto p-4 md:p-6 max-w-4xl",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Manage Unit Categories 3"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Configure your property unit categories 3 here."})]}),e.jsxs("button",{onClick:()=>n(!0),className:"inline-flex items-center justify-center gap-x-2 bg-orange-600 hover:bg-orange-700 text-white px-4 py-2 rounded-lg text-sm font-medium transition-colors focus:outline-none focus:ring-2 focus:ring-orange-500 focus:ring-offset-2",children:[e.jsx(J,{className:"h-5 w-5"}),e.jsx("span",{className:"sm:inline",children:"Add New"})]})]}),e.jsxs("form",{onSubmit:O,className:"flex items-center gap-2 w-full",children:[e.jsxs("div",{className:"relative flex-grow w-full",children:[e.jsx("div",{className:"pointer-events-none absolute inset-y-0 left-0 flex items-center pl-3",children:e.jsx(M,{className:"h-5 w-5 text-gray-400"})}),e.jsx("input",{type:"text",value:D,onChange:t=>U(t.target.value),placeholder:"Search by unit category 3...",className:"block w-full rounded-md border-0 py-2 pl-10 text-gray-900 ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-orange-600 sm:text-sm"})]}),e.jsx("button",{type:"submit",className:"hidden sm:flex items-center justify-center px-4 py-2 text-sm font-medium text-white bg-gray-800 rounded-md hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500",children:"Search"}),e.jsx("button",{type:"submit",className:"sm:hidden p-2 text-white bg-gray-800 rounded-md hover:bg-gray-700","aria-label":"Search",children:e.jsx(M,{className:"h-5 w-5"})}),w&&e.jsx("button",{type:"button",onClick:$,className:"p-2 text-sm font-medium text-gray-600 bg-gray-100 rounded-md hover:bg-gray-200","aria-label":"Clear search",children:e.jsx(K,{className:"h-5 w-5"})})]}),e.jsxs("div",{className:"bg-white shadow-sm ring-1 ring-gray-900/5 rounded-lg",children:[W(),d>z&&e.jsx("div",{className:"p-6 border-t border-gray-200",children:e.jsx(V,{breakLabel:"...",nextLabel:"›",onPageChange:I,pageRangeDisplayed:3,pageCount:R,previousLabel:"‹",renderOnZeroPageCount:null,forcePage:v-1,containerClassName:"flex items-center justify-center gap-2 text-base font-medium",pageClassName:"",pageLinkClassName:"w-10 h-10 flex items-center justify-center rounded-lg border border-gray-300 text-gray-900 hover:bg-gray-100 transition duration-200 cursor-pointer",activeClassName:"",activeLinkClassName:"bg-orange-500 text-white border-orange-500 hover:bg-orange-600",previousClassName:"",previousLinkClassName:"w-10 h-10 flex items-center justify-center rounded-lg border border-gray-300 text-gray-900 hover:bg-gray-100 transition duration-200 cursor-pointer",nextClassName:"",nextLinkClassName:"w-10 h-10 flex items-center justify-center rounded-lg border border-gray-300 text-gray-900 hover:bg-gray-100 transition duration-200 cursor-pointer",disabledClassName:"opacity-50 cursor-not-allowed",breakClassName:"",breakLinkClassName:"w-10 h-10 flex items-center justify-center rounded-lg border border-gray-300 text-gray-400"})})]})]}),e.jsx(ae,{isOpen:h,onClose:()=>n(!1),onSuccess:q}),r&&e.jsxs(e.Fragment,{children:[e.jsx(te,{isOpen:y,onClose:()=>a(!1),onSuccess:G,category:r}),e.jsx(se,{isOpen:c,onClose:()=>m(!1),onConfirm:B,isDeleting:f,itemName:r.unit_category_3})]})]})};export{me as default};
