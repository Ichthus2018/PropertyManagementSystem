const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/UnitsTable-xsW6Wp7B.js","assets/index-CD-AWF4T.js","assets/vendor-D0onPmP6.js","assets/ui-CRpVhgKF.js","assets/index-BCY66C8D.css","assets/TrashIcon-Dlbufv-M.js","assets/UnitCard-CovJxyYI.js","assets/UnitModal-CEUlpAYy.js","assets/Stepper-0NBI6azx.js","assets/react-paginate-Ca9dLlTL.js","assets/BuildingOffice2Icon-KGrlMzT7.js","assets/DataTable-CK62Tn4r.js","assets/ImageUploader-DWbVZMVl.js","assets/ImageUploader-BD8MpcyB.css","assets/ExclamationTriangleIcon-BI5VgTw-.js","assets/EditUnitModal-Dk26x669.js","assets/DeleteUnitModal-Dn6G-BXR.js"])))=>i.map(i=>d[i]);
import{b as t,_ as D}from"./vendor-D0onPmP6.js";import{j as e,z,L as $,e as T,q as V,f as q,s as M,g as U}from"./index-CD-AWF4T.js";import{u as B,R as G}from"./react-paginate-Ca9dLlTL.js";import{S as W,P as X,D as Y}from"./DataTable-CK62Tn4r.js";import{I as Z,v as J}from"./ImageUploader-DWbVZMVl.js";import{F as ee}from"./ExclamationTriangleIcon-BI5VgTw-.js";function te({title:l,titleId:a,...o},n){return t.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":a},o),l?t.createElement("title",{id:a},l):null,t.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16.023 9.348h4.992v-.001M2.985 19.644v-4.992m0 0h4.992m-4.993 0 3.181 3.183a8.25 8.25 0 0 0 13.803-3.7M4.031 9.865a8.25 8.25 0 0 1 13.803-3.7l3.181 3.182m0-4.991v4.99"}))}const se=t.forwardRef(te);function ae({title:l,titleId:a,...o},n){return t.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":a},o),l?t.createElement("title",{id:a},l):null,t.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 4.5v15m7.5-7.5h-15"}))}const ne=t.forwardRef(ae);function le({title:l,titleId:a,...o},n){return t.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":a},o),l?t.createElement("title",{id:a},l):null,t.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18 18 6M6 6l12 12"}))}const Q=t.forwardRef(le),re=["Wi-Fi","Air Conditioning","TV","Mini Bar","Hair Dryer","Room Service","Breakfast Included","Swimming Pool","Gym","Free Parking"];function ie({selectedAmenities:l,setSelectedAmenities:a}){const[o,n]=t.useState(""),m=s=>{const i=s.trim();i&&!l.includes(i)&&a([...l,i])},u=s=>{a(l.filter(i=>i!==s))},p=()=>{m(o),n("")},x=s=>{s.key==="Enter"&&(s.preventDefault(),p())};return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-900 mb-1.5",children:"Amenities"}),e.jsxs("div",{className:"mb-2",children:[e.jsx("p",{className:"text-sm font-medium text-gray-500 mb-2",children:"Selected Amenities:"}),e.jsx("div",{className:"flex flex-wrap gap-2 rounded-md min-h-[44px]",children:l.map(s=>e.jsxs("span",{className:"inline-flex items-center gap-x-1.5 rounded-full bg-orange-100 px-3 py-1 text-sm font-medium text-orange-800",children:[s,e.jsxs("button",{type:"button",onClick:()=>u(s),className:"-mr-0.5 h-5 w-5 rounded-full flex items-center justify-center text-orange-500 hover:bg-orange-200 hover:text-orange-700 focus:outline-none",children:[e.jsxs("span",{className:"sr-only",children:["Remove ",s]}),e.jsx(Q,{className:"h-4 w-4","aria-hidden":"true"})]})]},s))})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"text",value:o,onChange:s=>n(s.target.value),onKeyDown:x,placeholder:"Add a custom amenity",className:"w-full px-4 py-2 border border-neutral-300 rounded-md bg-white focus:outline-none focus:ring-2 focus:ring-orange-500 focus:border-orange-500 transition-colors"}),e.jsx("button",{type:"button",onClick:p,className:"rounded-md bg-orange-600 px-5 py-2.5 text-sm font-semibold text-white shadow-sm hover:bg-orange-500 focus-visible:outline  focus-visible:outline-offset-2 focus-visible:outline-orange-600 whitespace-nowrap",children:"Add"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-500 mb-2",children:"Suggested Amenities:"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:re.map(s=>e.jsxs("button",{type:"button",onClick:()=>m(s),disabled:l.includes(s),className:"inline-flex items-center gap-x-1 rounded-full bg-white px-3 py-1 text-sm font-medium text-gray-700 shadow-sm ring-1 ring-inset ring-gray-200 hover:bg-gray-50 disabled:cursor-not-allowed disabled:opacity-40",children:[e.jsx(ne,{className:"h-4 w-4 text-gray-500"}),s]},s))})]})]})}function oe({isOpen:l,onClose:a,onSuccess:o}){const[n,m]=t.useState(""),[u,p]=t.useState([]),[x,s]=t.useState([]),[i,f]=t.useState(!1),[y,h]=t.useState(null),b=()=>{m(""),p([]),s([]),f(!1),h(null),a()},j=async()=>{if(h(null),!!g){f(!0);try{const d=u[0].file,w=`public/${`${J()}-${d.name}`}`,{error:S}=await M.storage.from("facility-images").upload(w,d);if(S)throw S;const{data:k}=M.storage.from("facility-images").getPublicUrl(w),C=k.publicUrl,{error:F}=await M.from("facilities").insert({name:n,image_url:C,amenities:x}).select().single();if(F)throw F;o(),b()}catch(d){console.error("Failed to save facility:",d),h(`Error: ${d.message}. Please try again.`)}finally{f(!1)}}},g=n.trim()!==""&&u.length>0;return e.jsx(z,{appear:!0,show:l,as:t.Fragment,children:e.jsxs($,{as:"div",className:"relative z-50 font-sans",onClose:b,children:[e.jsx(T,{as:t.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:e.jsx("div",{className:"fixed inset-0 bg-black/30"})}),e.jsx("div",{className:"fixed inset-0 overflow-y-auto",children:e.jsx("div",{className:"flex min-h-full items-center justify-center p-4 text-center",children:e.jsx(T,{as:t.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0 scale-95",enterTo:"opacity-100 scale-100",leave:"ease-in duration-200",leaveFrom:"opacity-100 scale-100",leaveTo:"opacity-0 scale-95",children:e.jsxs(V,{className:"w-full max-w-2xl transform overflow-hidden rounded-2xl bg-white text-left align-middle shadow-2xl transition-all",children:[e.jsxs(q,{as:"h3",className:"flex justify-between items-center p-6 text-2xl font-semibold leading-6 text-neutral-900 border-b border-neutral-200",children:["Add New Facility",e.jsx("button",{onClick:b,className:"p-1 rounded-full text-neutral-400 hover:bg-neutral-100",children:e.jsx(Q,{className:"h-6 w-6"})})]}),e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"facility-name",className:"block text-sm font-medium text-gray-700",children:"Facility Name"}),e.jsx("div",{className:"mt-1 relative rounded-md shadow-sm",children:e.jsx("input",{type:"text",id:"facility-name",value:n,onChange:d=>m(d.target.value),className:"w-full px-4 py-2 border border-neutral-300 rounded-md bg-white focus:outline-none focus:ring-2 focus:ring-orange-500 focus:border-orange-500 transition-colors",placeholder:"e.g., Swimming Pool"})})]}),e.jsx(ie,{selectedAmenities:x,setSelectedAmenities:s}),e.jsx(Z,{label:"Facility Image",files:u,setFiles:p,maxFiles:1})]})}),e.jsxs("div",{className:"p-6 bg-neutral-50 border-t border-neutral-200 space-y-3",children:[y&&e.jsx("div",{className:"text-sm text-red-600 bg-red-50 p-3 rounded-md",children:y}),e.jsx("div",{className:"flex justify-end items-center",children:e.jsxs("button",{type:"button",onClick:j,disabled:!g||i,className:"inline-flex items-center px-6 py-2 text-sm font-medium text-white bg-orange-600 rounded-full shadow-lg hover:bg-orange-700 disabled:bg-neutral-400 transition-colors",children:[i&&e.jsx(se,{className:"w-4 h-4 mr-2 animate-spin"}),i?"Saving...":"Save Facility"]})})]})]})})})})]})})}const de=({isOpen:l,onClose:a,onConfirm:o,isDeleting:n,itemName:m})=>e.jsx(z,{appear:!0,show:l,as:t.Fragment,children:e.jsxs($,{as:"div",className:"relative z-50",onClose:a,children:[e.jsx(T,{as:t.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:e.jsx("div",{className:"fixed inset-0 bg-black/60"})}),e.jsx("div",{className:"fixed inset-0 overflow-y-auto",children:e.jsx("div",{className:"flex min-h-full items-center justify-center p-4 text-center",children:e.jsx(T,{as:t.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0 scale-95",enterTo:"opacity-100 scale-100",leave:"ease-in duration-200",leaveFrom:"opacity-100 scale-100",leaveTo:"opacity-0 scale-95",children:e.jsxs(V,{className:"w-full max-w-md transform overflow-hidden rounded-2xl bg-white p-6 text-left align-middle shadow-xl transition-all",children:[e.jsxs("div",{className:"sm:flex sm:items-start",children:[e.jsx("div",{className:"mx-auto flex h-12 w-12 flex-shrink-0 items-center justify-center rounded-full bg-red-100 sm:mx-0 sm:h-10 sm:w-10",children:e.jsx(ee,{className:"h-6 w-6 text-red-600","aria-hidden":"true"})}),e.jsxs("div",{className:"mt-3 text-center sm:ml-4 sm:mt-0 sm:text-left",children:[e.jsx(q,{as:"h3",className:"text-lg font-semibold leading-6 text-gray-900",children:"Delete Facility"}),e.jsx("div",{className:"mt-2",children:e.jsxs("p",{className:"text-sm text-gray-500",children:["Are you sure you want to delete"," ",e.jsx("strong",{className:"text-gray-800",children:m}),"? All associated data will be permanently removed. This action cannot be undone."]})})]})]}),e.jsxs("div",{className:"mt-5 sm:mt-4 sm:flex sm:flex-row-reverse",children:[e.jsx("button",{type:"button",disabled:n,onClick:o,className:"inline-flex w-full justify-center rounded-md bg-red-600 px-3 py-2 text-sm font-semibold text-white shadow-sm hover:bg-red-500 disabled:bg-red-300 sm:ml-3 sm:w-auto",children:n?"Deleting...":"Delete"}),e.jsx("button",{type:"button",onClick:a,disabled:n,className:"mt-3 inline-flex w-full justify-center rounded-md bg-white px-3 py-2 text-sm font-semibold text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 hover:bg-gray-50 sm:mt-0 sm:w-auto",children:"Cancel"})]})]})})})})]})});function ce(){const[l,a]=t.useState(!1),[o,n]=t.useState(!1),[m,u]=t.useState(null),[p,x]=t.useState(!1),[s,i]=t.useState(!1),[f,y]=t.useState(null),{data:h,totalCount:b,isLoading:j,error:g,mutate:d,currentPage:v,setCurrentPage:w,pageCount:S,pageSize:k,searchTerm:C,setSearchTerm:F,activeSearchTerm:_,handleSearch:P,clearSearch:E}=B({tableName:"facilities",selectQuery:"id, name, image_url, created_at",searchColumn:"name",initialPageSize:5}),O=r=>{w(r.selected+1)},A=()=>{i(!1),y(null),d()},L=r=>{y(r),i(!0)},I=()=>{i(!1),y(null)},R=()=>{a(!1),v!==1||_?E():d()},c=r=>{u(r),n(!0)},N=()=>{n(!1),u(null)},H=async()=>{if(m){x(!0);try{const{error:r}=await M.from("facilities").delete().eq("id",m.id);if(r)throw r;N(),h.length===1&&v>1?w(v-1):d()}catch(r){console.error("Error deleting facility:",r.message)}finally{x(!1)}}},K=()=>j&&!h.length?e.jsx("tr",{children:e.jsx("td",{colSpan:"3",className:"py-10 text-center",children:e.jsx(U,{})})}):g?e.jsx("tr",{children:e.jsx("td",{colSpan:"3",className:"text-center py-10 text-red-500",children:g})}):h.length===0?e.jsx("tr",{children:e.jsxs("td",{colSpan:"3",className:"text-center py-10 text-gray-500",children:[e.jsx("h4",{className:"font-semibold",children:_?"No Facilities Found":"No Facilities Yet"}),e.jsx("p",{className:"text-sm",children:_?"Try a different search term or clear the search.":'Click "Add Facility" to get started.'})]})}):h.map(r=>e.jsxs("tr",{children:[e.jsx("td",{className:"whitespace-nowrap py-4 pl-4 pr-3 text-sm sm:pl-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"h-11 w-11 flex-shrink-0",children:e.jsx("img",{className:"h-11 w-11 rounded-full object-cover",src:r.image_url,alt:r.name})}),e.jsx("div",{className:"ml-4",children:e.jsx("div",{className:"font-medium text-gray-900",children:r.name})})]})}),e.jsx("td",{className:"px-3 py-4 text-sm text-gray-500",children:e.jsx("span",{className:"text-xs text-gray-400",children:"Not assigned"})}),e.jsxs("td",{className:"relative whitespace-nowrap py-4 pl-3 pr-4 text-right text-sm font-medium sm:pr-6",children:[e.jsxs("button",{onClick:()=>L(r),className:"text-orange-600 hover:text-orange-900",children:["Edit",e.jsxs("span",{className:"sr-only",children:[", ",r.name]})]}),e.jsxs("button",{onClick:()=>c(r),className:"ml-4 text-red-600 hover:text-red-900",children:["Delete",e.jsxs("span",{className:"sr-only",children:[", ",r.name]})]})]})]},r.id));return e.jsxs(e.Fragment,{children:[e.jsx(oe,{isOpen:l,onClose:()=>a(!1),onSuccess:R}),f&&e.jsx(EditFacilityModals,{isOpen:s,onClose:I,onSuccess:A,facility:f}),e.jsx(de,{isOpen:o,onClose:N,onConfirm:H,isDeleting:p,itemName:m?.name||""}),e.jsxs("div",{className:"space-y-6 w-full mx-auto p-4 pt-15 md:p-6 max-w-[95rem] xl:px-12",children:[e.jsxs("div",{className:"sm:flex sm:items-center",children:[e.jsxs("div",{className:"sm:flex-auto",children:[e.jsx("h1",{className:"text-xl font-semibold leading-6 text-gray-900",children:"Facilities Management"}),e.jsx("p",{className:"mt-2 text-sm text-gray-700",children:"A list of all available facilities in the property."})]}),e.jsx("div",{className:"mt-4 sm:ml-16 sm:mt-0 sm:flex-none",children:e.jsx("button",{onClick:()=>a(!0),type:"button",className:"block rounded-md bg-orange-600 px-3 py-2 text-center text-sm font-semibold text-white shadow-sm hover:bg-orange-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-orange-600",children:"Add Facility"})})]}),e.jsx("div",{className:"flex items-center gap-2 w-full0",children:e.jsx(W,{searchTerm:C,setSearchTerm:F,activeSearchTerm:_,onSearch:P,onClear:E,placeholder:"Search by facility name..."})}),e.jsx("div",{className:"mt-8 flow-root",children:e.jsx("div",{className:"-mx-4 -my-2 overflow-x-auto sm:-mx-6 lg:-mx-8",children:e.jsx("div",{className:"inline-block min-w-full py-2 align-middle sm:px-6 lg:px-8",children:e.jsxs("div",{className:"overflow-hidden shadow ring-1 ring-black ring-opacity-5 sm:rounded-lg",children:[e.jsxs("table",{className:"min-w-full divide-y divide-gray-300",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",className:"py-3.5 pl-4 pr-3 text-left text-sm font-semibold text-gray-900 sm:pl-6",children:"Facility"}),e.jsx("th",{scope:"col",className:"px-3 py-3.5 text-left text-sm font-semibold text-gray-900",children:"Assigned Units"}),e.jsx("th",{scope:"col",className:"relative py-3.5 pl-3 pr-4 sm:pr-6",children:e.jsx("span",{className:"sr-only",children:"Edit"})})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200 bg-white",children:K()})]}),b>k&&e.jsx("div",{className:"p-4 border-t border-gray-200",children:e.jsx(G,{breakLabel:"...",nextLabel:"›",onPageChange:O,pageRangeDisplayed:3,pageCount:S,previousLabel:"‹",renderOnZeroPageCount:null,forcePage:v-1,containerClassName:"flex items-center justify-center gap-2 text-sm font-medium",pageLinkClassName:"w-8 h-8 flex items-center justify-center rounded-md border border-gray-300 text-gray-900 hover:bg-gray-100 transition",activeLinkClassName:"bg-orange-600 text-white border-orange-600 hover:bg-orange-700",previousLinkClassName:"w-8 h-8 flex items-center justify-center rounded-md border border-gray-300 text-gray-900 hover:bg-gray-100 transition",nextLinkClassName:"w-8 h-8 flex items-center justify-center rounded-md border border-gray-300 text-gray-900 hover:bg-gray-100 transition",disabledClassName:"opacity-50 cursor-not-allowed"})})]})})})})]})]})}const me=t.lazy(()=>D(()=>import("./UnitsTable-xsW6Wp7B.js"),__vite__mapDeps([0,1,2,3,4,5]))),ue=t.lazy(()=>D(()=>import("./UnitCard-CovJxyYI.js"),__vite__mapDeps([6,1,2,3,4,5]))),xe=t.lazy(()=>D(()=>import("./UnitModal-CEUlpAYy.js"),__vite__mapDeps([7,1,2,3,4,8,9,10,11,12,13,14]))),he=t.lazy(()=>D(()=>import("./EditUnitModal-Dk26x669.js"),__vite__mapDeps([15,1,2,3,4,9,10,11,12,13,14]))),pe=t.lazy(()=>D(()=>import("./DeleteUnitModal-Dn6G-BXR.js"),__vite__mapDeps([16,1,2,3,4,14]))),fe=()=>{const[l,a]=t.useState(!1),[o,n]=t.useState(!1),[m,u]=t.useState(!1),[p,x]=t.useState(!1),[s,i]=t.useState(null),{data:f,totalCount:y,isLoading:h,error:b,mutate:j,currentPage:g,setCurrentPage:d,pageCount:v,pageSize:w,searchTerm:S,setSearchTerm:k,activeSearchTerm:C,handleSearch:F,clearSearch:_}=B({tableName:"units",selectQuery:`
      id, name, sqm, property_id,
      unit_type_id,
      leasing_type_id,
      unit_category_id,
      unit_category_2_id,
      unit_category_3_id,
      properties (property_name, number_of_units, total_sqm), 
      unit_types (unit_type)
    `,searchColumn:"name",initialPageSize:10}),P=()=>{a(!1),j()},E=c=>{i(c),n(!0)},O=()=>{n(!1),i(null),j()},A=c=>{i(c),u(!0)},L=async()=>{if(s){x(!0);try{const{error:c}=await M.from("units").delete().eq("id",s.id);if(c)throw c;f.length===1&&g>1?d(g-1):j()}catch(c){console.error("Failed to delete unit:",c)}finally{x(!1),u(!1),i(null)}}},I=c=>e.jsx(t.Suspense,{fallback:e.jsx(U,{}),children:e.jsx(me,{units:c,onEdit:E,onDelete:A})}),R=c=>e.jsx(t.Suspense,{fallback:e.jsx(U,{}),children:e.jsx("div",{className:"space-y-4 p-4",children:c.map(N=>e.jsx(ue,{unit:N,onEdit:()=>E(N),onDelete:()=>A(N)},N.id))})});return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-6 w-full mx-auto p-4 pt-15 md:p-6 max-w-[95rem] xl:px-12",children:[e.jsx(X,{title:"Manage Units",description:"View, edit, and manage all property units.",buttonText:"Add New Units",onButtonClick:()=>a(!0)}),e.jsx(W,{searchTerm:S,setSearchTerm:k,activeSearchTerm:C,onSearch:F,onClear:_,placeholder:"Search by unit name..."}),e.jsx(Y,{isLoading:h,error:b,data:f,totalCount:y,pageCount:v,currentPage:g,onPageChange:d,pageSize:w,activeSearchTerm:C,renderTable:I,renderCards:R,emptyStateTitle:"No Units Found",emptyStateDescription:'Click "Add New Units" to get started.'})]}),e.jsxs(t.Suspense,{fallback:null,children:[e.jsx(xe,{isOpen:l,onClose:()=>a(!1),onSuccess:P}),s&&e.jsxs(e.Fragment,{children:[e.jsx(he,{isOpen:o,onClose:()=>n(!1),onSuccess:O,unit:s}),e.jsx(pe,{isOpen:m,onClose:()=>u(!1),onConfirm:L,isDeleting:p,itemName:s.name})]})]}),e.jsx(ce,{})]})},Ne=Object.freeze(Object.defineProperty({__proto__:null,default:fe},Symbol.toStringTag,{value:"Module"}));export{Q as F,Ne as U};
