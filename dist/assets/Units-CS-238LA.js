const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/UnitsTable-BN9cfCN2.js","assets/index-Bu7T6usM.js","assets/vendor-CltuolhD.js","assets/ui-BZV_7ZZi.js","assets/index-5ea9rJB0.css","assets/TrashIcon-CtbRN9aw.js","assets/UnitCard-BBu5bN9k.js","assets/UnitModal-Cpla-N4Y.js","assets/Stepper-OB66GHAN.js","assets/react-paginate-vCY7IKIj.js","assets/XMarkIcon-CWkBaw58.js","assets/EditUnitModal-Cqzcyu_o.js","assets/DeleteUnitModal-BAcy-VqU.js","assets/ExclamationTriangleIcon-CY9RlToI.js"])))=>i.map(i=>d[i]);
import{b as t,_ as n}from"./vendor-CltuolhD.js";import{j as e,L as h,s as N}from"./index-Bu7T6usM.js";import{u as k}from"./react-paginate-vCY7IKIj.js";import{P as R,S as V,D as F}from"./DataTable-CR7nGn7h.js";import"./ui-BZV_7ZZi.js";const q=t.lazy(()=>n(()=>import("./UnitsTable-BN9cfCN2.js"),__vite__mapDeps([0,1,2,3,4,5]))),Q=t.lazy(()=>n(()=>import("./UnitCard-BBu5bN9k.js"),__vite__mapDeps([6,1,2,3,4,5]))),B=t.lazy(()=>n(()=>import("./UnitModal-Cpla-N4Y.js"),__vite__mapDeps([7,1,2,3,4,8,9,10]))),H=t.lazy(()=>n(()=>import("./EditUnitModal-Cqzcyu_o.js"),__vite__mapDeps([11,1,2,3,4,9,10]))),G=t.lazy(()=>n(()=>import("./DeleteUnitModal-BAcy-VqU.js"),__vite__mapDeps([12,1,2,3,4,13]))),Z=()=>{const[y,i]=t.useState(!1),[g,l]=t.useState(!1),[E,d]=t.useState(!1),[j,p]=t.useState(!1),[a,o]=t.useState(null),{data:_,totalCount:D,isLoading:C,error:b,mutate:c,currentPage:u,setCurrentPage:m,pageCount:O,pageSize:P,searchTerm:T,setSearchTerm:M,activeSearchTerm:f,handleSearch:U,clearSearch:A}=k({tableName:"units",selectQuery:`
      id, name, sqm, property_id,
      unit_type_id,
      leasing_type_id,
      unit_category_id,
      unit_category_2_id,
      unit_category_3_id,
      properties (property_name, number_of_units, total_sqm), 
      unit_types (unit_type)
    `,searchColumn:"name",initialPageSize:10}),I=()=>{i(!1),c()},S=s=>{o(s),l(!0)},v=()=>{l(!1),o(null),c()},x=s=>{o(s),d(!0)},L=async()=>{if(a){p(!0);try{const{error:s}=await N.from("units").delete().eq("id",a.id);if(s)throw s;_.length===1&&u>1?m(u-1):c()}catch(s){console.error("Failed to delete unit:",s)}finally{p(!1),d(!1),o(null)}}},w=s=>e.jsx(t.Suspense,{fallback:e.jsx(h,{}),children:e.jsx(q,{units:s,onEdit:S,onDelete:x})}),z=s=>e.jsx(t.Suspense,{fallback:e.jsx(h,{}),children:e.jsx("div",{className:"space-y-4 p-4",children:s.map(r=>e.jsx(Q,{unit:r,onEdit:()=>S(r),onDelete:()=>x(r)},r.id))})});return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-6 w-full mx-auto p-4 pt-15 md:p-6 max-w-[95rem] xl:px-12",children:[e.jsx(R,{title:"Manage Units",description:"View, edit, and manage all property units.",buttonText:"Add New Units",onButtonClick:()=>i(!0)}),e.jsx(V,{searchTerm:T,setSearchTerm:M,activeSearchTerm:f,onSearch:U,onClear:A,placeholder:"Search by unit name..."}),e.jsx(F,{isLoading:C,error:b,data:_,totalCount:D,pageCount:O,currentPage:u,onPageChange:m,pageSize:P,activeSearchTerm:f,renderTable:w,renderCards:z,emptyStateTitle:"No Units Found",emptyStateDescription:'Click "Add New Units" to get started.'})]}),e.jsxs(t.Suspense,{fallback:null,children:[e.jsx(B,{isOpen:y,onClose:()=>i(!1),onSuccess:I}),a&&e.jsxs(e.Fragment,{children:[e.jsx(H,{isOpen:g,onClose:()=>l(!1),onSuccess:v,unit:a}),e.jsx(G,{isOpen:E,onClose:()=>d(!1),onConfirm:L,isDeleting:j,itemName:a.name})]})]})]})};export{Z as default};
